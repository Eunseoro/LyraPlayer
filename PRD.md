# **LyraPlayer 통합 제품 기획 및 기술 명세서**

**프로젝트 제목:** LyraPlayer

---

## 1. 소개

LyraPlayer는 YouTube를 주요 소스로 활용하여 음악 및 영상을 재생할 수 있는 웹 기반 멀티미디어 플레이어입니다. 사용자가 재생목록을 자유롭게 구성하고 각 트랙에 시간 동기화된 가사를 연동할 수 있는 직관적인 인터페이스를 제공합니다. 모바일과 데스크톱을 모두 지원하는 반응형 웹으로 구현되며, 향후 다른 미디어 소스 지원 및 사용자 계정 기능 등으로 확장할 수 있도록 설계되었습니다.

## 2. 목적 및 주요 목표

### 2.1 목적
- 간편하고 직관적인 웹 기반 멀티미디어 플레이어 개발
- YouTube 콘텐츠에 시간 동기화된 가사를 연동하여 향상된 사용자 경험 제공
- 사용자가 손쉽게 재생목록을 구성하고 관리할 수 있는 플랫폼 제공
- 모든 기기에서 일관된 경험을 제공하는 반응형 웹 애플리케이션 구현

### 2.2 주요 목표
- 재생 제어가 완벽한 간결하고 효율적인 플레이어 UI 구현
- 직관적인 재생목록 생성 및 관리 시스템 개발
- LRC 형식 기반의 시간 동기화된 가사 표시 기능
- 데스크톱 및 모바일 기기에 최적화된 반응형 디자인
- 서버리스 환경(Vercel)에 배포하여 안정적인 서비스 제공
- 테마 모드(라이트/다크) 지원을 통한 사용자 편의성 향상

### 2.3 대상 사용자
- 음악 감상 시 가사를 함께 보고 싶은 사용자
- 커스텀 재생목록을 쉽게 구성하고 싶은 사용자
- 다양한 기기에서 일관된 미디어 경험을 원하는 사용자
- 협업 및 테스트를 위한 내부 팀원
- 향후: 개인화된 콘텐츠를 저장하고 관리하는 등록 사용자

## 3. 핵심 기능 및 기술 명세

### 3.1 미디어 플레이어 (YouTubePlayer)

**역할:** YouTube iFrame API를 사용하여 영상/음악을 재생

**기능:**
- `videoId` prop으로 유튜브 콘텐츠 로딩
- URL 붙여넣기 또는 검색을 통한 입력 방법 (MVP에서는 검색 선택 사항)
- 재생 제어: 재생/일시정지, 탐색, 볼륨 조절, 음소거, 전체 화면
- 상태 바인딩: 재생/정지, 현재 시간, 버퍼 상태, 끝남 이벤트 등
- YouTube Data API를 사용한 메타데이터 파싱 (제목, 썸네일, 길이 등)
- 영상 로딩 실패 및 네트워크 오류 핸들링
- 상태 동기화를 위해 내부적으로 `postMessage` 방식 사용

**기술 요소:** `useEffect`, `ref`, `postMessage API`, `YouTube iFrame API`

### 3.2 재생 제어 (PlaybackControls)

**역할:** 현재 재생 중인 콘텐츠의 제어 인터페이스

**기능:**
- 버튼: 재생/일시정지, 이전/다음, 반복, 랜덤 (옵션)
- 시크바: 현재 위치 표시 및 이동
- 음량 조절: range input으로 구현
- 전체 상태는 글로벌 스토어(Zustand)로 연결

**기술 요소:** `zustand`, `Slider`, `onInput`, `onClick`

### 3.3 재생목록 시스템 (PlaylistList & PlaylistItem)

**역할:** 사용자 재생목록을 생성, 관리, 표시

**기능:**
- 재생 목록 CRUD: 추가, 이름 수정, 삭제 가능
- 트랙 추가/제거: URL 붙여넣기로 항목 추가
- 드래그 앤 드롭으로 순서 변경 (`dnd-kit` 사용)
- 브라우저 로컬 스토리지에 재생 목록 상태 자동 저장
- 각 항목의 재생 목록 썸네일, 제목, 재생 시간 표시

**기술 요소:** `useState`, `useLocalStorage`, `uuid`, `dnd-kit`, `onDragEnd`

### 3.4 가사 동기화 및 표시 (LyricsDisplay)

**역할:** 현재 재생 중인 콘텐츠에 동기화된 가사 표시

**기능:**
- LRC 형식 기반 싱크 가사 연동
- `.lrc` 파일 업로드 지원 또는 타임스탬프가 있는 가사 수동 입력
- `.lrc` 파싱 후 timestamp 기반 라인 배열 생성
- 현재 영상 시간과 가사 시간 비교 후, 해당 라인 강조
- 자동 스크롤 기능 포함 (`scrollIntoView` 활용)
- 스크롤 가능하고 반응형 가사 보기
- 비동기 또는 로컬 JSON 기반으로 가사 파일 로딩
- 수동 입력/수정 기능은 편집 모드에서 제공 예정

**기술 요소:** `useEffect` (타이머 동기화), `scrollRef`, `.lrc` custom parser

### 3.5 UI 및 사용자 환경

**역할:** 직관적이고 최소한의 조작으로 감상 가능한 인터페이스 제공

**기능:**
- 반응형 웹 구성 (모바일/PC 대응)
- 재생 중 가사 연동 인터페이스
- 테마 모드 (라이트/다크) 선택 가능
- TailwindCSS 반응형 유틸리티를 활용한 모바일 최적화
- 작은 화면에서는 사이드바를 서랍으로 축소
- 세로 방향에서 전체 화면 비디오 플레이어 지원

**기술 요소:** `TailwindCSS`, UI 컴포넌트 라이브러리(`shadcn/ui`)

### 3.6 전역 상태 관리 (Global State Store - Zustand 기반)

**역할:** 재생 상태 및 전역 데이터 관리

**기능:**
- 현재 트랙 정보, 재생 상태, 볼륨, 재생목록 선택 등 관리
- 공유된 상태에 따라 YouTubePlayer, LyricsDisplay, Controls 모두 동작

```ts
interface PlayerState {
  currentTrack: Track;
  isPlaying: boolean;
  currentTime: number;
  volume: number;
  playlist: Playlist[];
  setTrack: (track: Track) => void;
  // ...
}
```

**기술 요소:** `zustand`, `immer`, `middleware(persist)`

## 4. 기술 스택 및 구조

### 4.1 기술 스택
- **프론트엔드:** React (Vite 기반), TypeScript
- **스타일링:** TailwindCSS
- **상태 관리:** Zustand
- **라우팅:** React Router
- **배포:** Vercel (자동 배포 및 프리뷰 환경 제공)
- **미디어 API:** YouTube iFrame API, YouTube Data API v3
- **성능 최적화:** 빠른 로드를 위한 최적화 (Vite와 코드 분할)
- **호환성:** 최신 Chrome, Safari, Firefox, Edge와 호환

### 4.2 레이아웃 구조
- 왼쪽 사이드바: 재생 목록 목록 및 탐색
- 메인 패널: 동영상 플레이어 및 가사
- 하단 패널: 미디어 제어

### 4.3 컴포넌트 구조 트리
```
App
├── Layout
│   ├── Sidebar
│   │   ├── PlaylistList
│   │   └── PlaylistItem
│   ├── MainPanel
│   │   ├── YouTubePlayer
│   │   └── LyricsDisplay
│   └── BottomPanel
│       └── PlaybackControls
```

**설명:**
- `App`: 전체 루트 컴포넌트, 전역 상태 관리 및 테마 처리 포함
- `Layout`: 화면 구성 주체로서, Sidebar / MainPanel / BottomPanel로 구성
- `Sidebar`: 재생목록을 관리하는 패널
  - `PlaylistList`: 모든 재생목록을 나열
  - `PlaylistItem`: 개별 재생목록의 항목 구성
- `MainPanel`: 플레이어와 가사 영역
  - `YouTubePlayer`: 유튜브 영상 임베드 및 재생 제어
  - `LyricsDisplay`: 동기화된 가사 표시
- `BottomPanel`: 하단 재생 컨트롤 영역
  - `PlaybackControls`: 재생, 일시정지, 음량, 시크바 등 포함

## 5. 기술 설계의 핵심 포인트
- **단방향 데이터 흐름** 유지
- **상태는 최소화하고 공유화**: 상태는 store에서 관리, UI는 props 기반
- **모든 시간 관련 기능은 YouTube API 시간과 동기화**되도록 처리
- **LRC 파싱/렌더링은 별도 유틸로 분리**하여 재사용 가능성 확보
- **직관적이고 최소한의 조작**으로 미디어 감상이 가능한 인터페이스 설계

## 6. 개발 일정 및 작업 단계

### 주차별 작업 계획

| 주차 | 목표 | 세부 작업 |
|------|------|-----------|
| 1주차 | 프로젝트 초기화 및 기본 플레이어 구현 | - Vite + React 프로젝트 생성<br>- TailwindCSS 적용<br>- YouTube API 연동 (iFrame API)<br>- 영상 재생 및 컨트롤 구현<br>- 기본 레이아웃 구성 |
| 2주차 | 재생목록 및 가사 처리 기능 개발 | - 재생목록 CRUD 상태관리 로직 작성<br>- 트랙 추가/삭제/순서변경 기능 구현<br>- LRC 파서 구현<br>- 가사 동기화 인터페이스 구성 |
| 3주차 | UI 정비 및 반응형 대응 | - 전체 페이지 구성 마무리<br>- 반응형 레이아웃 구현 (Tailwind breakpoints)<br>- 가사 스크롤 및 애니메이션 효과 적용<br>- UX 개선 작업 |
| 4주차 | 배포 및 기능 고도화 | - Vercel 배포 설정 및 도메인 연결<br>- 예외 처리 및 오류 대응 추가<br>- 유튜브 외 미디어 소스 초기 대응 가능성 검토<br>- 프로젝트 README 작성 및 최종 테스트 |

### 단계별 세부 작업

#### 단계 1: 프로젝트 설정
- [ ] Vite + React + TS 템플릿을 사용하여 프로젝트 초기화
- [ ] TailwindCSS 및 다크 모드 지원 설정
- [ ] 전역 UI 레이아웃 구성 요소 정의 (사이드바, 플레이어, 가사 패널)
- [ ] 라우팅 설정 (다중 페이지인 경우)

#### 단계 2: YouTube 플레이어
- [ ] 동적 비디오 로딩 기능이 있는 YouTube iFrame 임베드
- [ ] 제어 바인딩 추가 (재생, 일시 중지, 검색 등)
- [ ] 비디오 메타데이터 파싱 및 표시

#### 단계 3: 재생목록 관리
- [ ] 재생 목록 데이터 모델 구축 (ID, 이름, 항목[])
- [ ] 재생 목록 및 항목을 위한 CRUD UI 생성
- [ ] 드래그 앤 드롭 구현 (예: dnd-kit)
- [ ] localStorage에 재생 목록 저장

#### 단계 4: 가사 동기화
- [ ] LRC 파일 파서 구현
- [ ] 스크롤 + 강조 표시 기능이 있는 가사 뷰어 구축
- [ ] 현재 가사 라인을 비디오 시간과 동기화
- [ ] 수동 가사 타임스탬프 입력/편집 활성화

#### 단계 5: UI/UX 개선
- [ ] TailwindCSS를 사용하여 모든 구성 요소 스타일링
- [ ] 전환/애니메이션 추가
- [ ] 주요 브레이크포인트에서 반응성 테스트
- [ ] 빈/오류 상태를 적절하게 처리

#### 단계 6: 배포
- [ ] 프로덕션 배포를 위한 Vercel 구성
- [ ] 사용자 정의 도메인 설정 (선택 사항)
- [ ] README 및 사용자 온보딩 가이드 준비

## 7. 확장 고려 사항 및 향후 개선 방향

### MVP 이후 개선 사항
- 사용자 인증 및 백엔드로 재생 목록 동기화 (Firebase Auth/Firestore)
- 재생 히스토리/즐겨찾기 기능
- Gist 기반 또는 외부 파일 로딩 가사
- 가사 자동 검색 API 연동 (예: Musixmatch, Genius)
- 미디어 업로드 (MP3/MP4 로컬 파일 재생)
- SoundCloud, Vimeo 등 다중 미디어 소스 대응
- 다국어 인터페이스, 다국어 가사 처리
- PWA 기반 오프라인 캐싱 재생 지원
